<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Terminal Calypso C++ API 1.4.0-SNAPSHOT: calypsonet::terminal::calypso::transaction::CardTransactionManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Terminal Calypso C++ API 1.4.0-SNAPSHOT
   </div>
   <div id="projectbrief">Reference Terminal Calypso API for C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecalypsonet.html">calypsonet</a></li><li class="navelem"><a class="el" href="namespacecalypsonet_1_1terminal.html">terminal</a></li><li class="navelem"><a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso.html">calypso</a></li><li class="navelem"><a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso_1_1transaction.html">transaction</a></li><li class="navelem"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">calypsonet::terminal::calypso::transaction::CardTransactionManager Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_card_transaction_manager_8h_source.html">CardTransactionManager.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for calypsonet::terminal::calypso::transaction::CardTransactionManager:</div>
<div class="dyncontent">
<div class="center"><img src="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager__inherit__graph.png" border="0" usemap="#acalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager_inherit__map" alt="Inheritance graph"/></div>
<map name="acalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager_inherit__map" id="acalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager_inherit__map">
<area shape="rect" title=" " alt="" coords="252,20,425,76"/>
<area shape="rect" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html" title=" " alt="" coords="5,5,204,91"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for calypsonet::terminal::calypso::transaction::CardTransactionManager:</div>
<div class="dyncontent">
<div class="center"><img src="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager__coll__graph.png" border="0" usemap="#acalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager_coll__map" alt="Collaboration graph"/></div>
<map name="acalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager_coll__map" id="acalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager_coll__map">
<area shape="rect" title=" " alt="" coords="252,20,425,76"/>
<area shape="rect" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html" title=" " alt="" coords="5,5,204,91"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab7a3d399c1a5fd0a93ec534203059478"><td class="memItemLeft" align="right" valign="top">virtual const std::shared_ptr&lt; CardReader &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ab7a3d399c1a5fd0a93ec534203059478">getCardReader</a> () const =0</td></tr>
<tr class="separator:ab7a3d399c1a5fd0a93ec534203059478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ec7763db77a1102e6d5cda98892e0fe"><td class="memItemLeft" align="right" valign="top">virtual const std::shared_ptr&lt; <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">CalypsoCard</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a1ec7763db77a1102e6d5cda98892e0fe">getCalypsoCard</a> () const =0</td></tr>
<tr class="separator:a1ec7763db77a1102e6d5cda98892e0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af09581a52286a3759e39e982f27d04b2"><td class="memItemLeft" align="right" valign="top">virtual const std::shared_ptr&lt; <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_security_setting.html">CardSecuritySetting</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#af09581a52286a3759e39e982f27d04b2">getCardSecuritySetting</a> () const =0</td></tr>
<tr class="separator:af09581a52286a3759e39e982f27d04b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299841a2f10ac38926daddce25958e0e"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a299841a2f10ac38926daddce25958e0e">prepareSelectFile</a> (const std::vector&lt; uint8_t &gt; &amp;lid)=0</td></tr>
<tr class="separator:a299841a2f10ac38926daddce25958e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a58e196deea760cba8be392574b1cf7"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a5a58e196deea760cba8be392574b1cf7">prepareSelectFile</a> (const uint16_t lid)=0</td></tr>
<tr class="separator:a5a58e196deea760cba8be392574b1cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68497bf751b092696e9ab6eded82f1da"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a68497bf751b092696e9ab6eded82f1da">prepareSelectFile</a> (const <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso.html#ab3b5c5c0a3d6688a55ea7cab10d0d748">SelectFileControl</a> selectFileControl)=0</td></tr>
<tr class="separator:a68497bf751b092696e9ab6eded82f1da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02415c131fec75b6d2b00347e5c07103"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a02415c131fec75b6d2b00347e5c07103">prepareGetData</a> (const <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso.html#adfb916965f55ec8780fe2dba24db3bff">GetDataTag</a> tag)=0</td></tr>
<tr class="separator:a02415c131fec75b6d2b00347e5c07103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81adf09121b6d8de19bb0bd456754df3"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a81adf09121b6d8de19bb0bd456754df3">prepareReadRecordFile</a> (const uint8_t sfi, const uint8_t recordNumber)=0</td></tr>
<tr class="separator:a81adf09121b6d8de19bb0bd456754df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fdc266749359d06709637515974c387"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a5fdc266749359d06709637515974c387">prepareReadRecordFile</a> (const uint8_t sfi, const uint8_t firstRecordNumber, const uint8_t numberOfRecords, const uint8_t recordSize)=0</td></tr>
<tr class="separator:a5fdc266749359d06709637515974c387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae537c2cf99e118c9b6b719fc465b3370"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ae537c2cf99e118c9b6b719fc465b3370">prepareReadCounterFile</a> (const uint8_t sfi, const uint8_t countersNumber)=0</td></tr>
<tr class="separator:ae537c2cf99e118c9b6b719fc465b3370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad945048d3ffb7cb8b75ea137d5d68dbe"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad945048d3ffb7cb8b75ea137d5d68dbe">prepareReadRecord</a> (const uint8_t sfi, const uint8_t recordNumber)=0</td></tr>
<tr class="separator:ad945048d3ffb7cb8b75ea137d5d68dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5c992dc5952de139b25c68081931593"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ae5c992dc5952de139b25c68081931593">prepareReadRecords</a> (const uint8_t sfi, const uint8_t fromRecordNumber, const uint8_t toRecordNumber, const uint8_t recordSize)=0</td></tr>
<tr class="separator:ae5c992dc5952de139b25c68081931593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c1a93fca710b0af2291c3a465e1bb4"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad2c1a93fca710b0af2291c3a465e1bb4">prepareReadRecordsPartially</a> (const uint8_t sfi, const uint8_t fromRecordNumber, const uint8_t toRecordNumber, const uint8_t offset, const uint8_t nbBytesToRead)=0</td></tr>
<tr class="separator:ad2c1a93fca710b0af2291c3a465e1bb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb0dadeb585b832731cf6cadf4e80a30"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#afb0dadeb585b832731cf6cadf4e80a30">prepareReadBinary</a> (const uint8_t sfi, const uint8_t offset, const uint8_t nbBytesToRead)=0</td></tr>
<tr class="separator:afb0dadeb585b832731cf6cadf4e80a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d4a52b014aa766504f0d60f43b92c08"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a8d4a52b014aa766504f0d60f43b92c08">prepareReadCounter</a> (const uint8_t sfi, const uint8_t nbCountersToRead)=0</td></tr>
<tr class="separator:a8d4a52b014aa766504f0d60f43b92c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38887edb3ac6110c3d0e831c71707475"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a38887edb3ac6110c3d0e831c71707475">prepareSearchRecords</a> (const std::shared_ptr&lt; <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_search_command_data.html">SearchCommandData</a> &gt; data)=0</td></tr>
<tr class="separator:a38887edb3ac6110c3d0e831c71707475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bc9d47aa43eb13dfc9a992f3f42b25a"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a9bc9d47aa43eb13dfc9a992f3f42b25a">prepareCheckPinStatus</a> ()=0</td></tr>
<tr class="separator:a9bc9d47aa43eb13dfc9a992f3f42b25a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22dda308b73fff151b65ebbdda760fbf"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a22dda308b73fff151b65ebbdda760fbf">prepareAppendRecord</a> (const uint8_t sfi, const std::vector&lt; uint8_t &gt; &amp;recordData)=0</td></tr>
<tr class="separator:a22dda308b73fff151b65ebbdda760fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2359a27dfe5d4bfca411dc6b55f29f9"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#af2359a27dfe5d4bfca411dc6b55f29f9">prepareUpdateRecord</a> (const uint8_t sfi, const uint8_t recordNumber, const std::vector&lt; uint8_t &gt; &amp;recordData)=0</td></tr>
<tr class="separator:af2359a27dfe5d4bfca411dc6b55f29f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e76775f5506b0d72ec15ab30c5bb457"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a7e76775f5506b0d72ec15ab30c5bb457">prepareWriteRecord</a> (const uint8_t sfi, const uint8_t recordNumber, const std::vector&lt; uint8_t &gt; &amp;recordData)=0</td></tr>
<tr class="separator:a7e76775f5506b0d72ec15ab30c5bb457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a580630654d58b1f5e0487b4802925450"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a580630654d58b1f5e0487b4802925450">prepareUpdateBinary</a> (const uint8_t sfi, const uint8_t offset, const std::vector&lt; uint8_t &gt; &amp;data)=0</td></tr>
<tr class="separator:a580630654d58b1f5e0487b4802925450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18934a399c7f4ce96c9a45cc80c8ebef"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a18934a399c7f4ce96c9a45cc80c8ebef">prepareWriteBinary</a> (const uint8_t sfi, const uint8_t offset, const std::vector&lt; uint8_t &gt; &amp;data)=0</td></tr>
<tr class="separator:a18934a399c7f4ce96c9a45cc80c8ebef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafda6939a220c0877d8732e3d3ccbd65"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#aafda6939a220c0877d8732e3d3ccbd65">prepareIncreaseCounter</a> (const uint8_t sfi, const uint8_t counterNumber, const int incValue)=0</td></tr>
<tr class="separator:aafda6939a220c0877d8732e3d3ccbd65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed6e60678ad82ee11011827a53befbfc"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#aed6e60678ad82ee11011827a53befbfc">prepareIncreaseCounters</a> (const uint8_t sfi, const std::map&lt; const int, const int &gt; &amp;counterNumberToIncValueMap)=0</td></tr>
<tr class="separator:aed6e60678ad82ee11011827a53befbfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dee576191d3fcf8faefd03d8d15d198"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a0dee576191d3fcf8faefd03d8d15d198">prepareDecreaseCounter</a> (const uint8_t sfi, const uint8_t counterNumber, const int decValue)=0</td></tr>
<tr class="separator:a0dee576191d3fcf8faefd03d8d15d198"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4423d44184d71297ea741f46f68998"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#afa4423d44184d71297ea741f46f68998">prepareDecreaseCounters</a> (const uint8_t sfi, const std::map&lt; const int, const int &gt; &amp;counterNumberToDecValueMap)=0</td></tr>
<tr class="separator:afa4423d44184d71297ea741f46f68998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd583fc16be734520d00bf77847a7d0b"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#abd583fc16be734520d00bf77847a7d0b">prepareSetCounter</a> (const uint8_t sfi, const uint8_t counterNumber, const int newValue)=0</td></tr>
<tr class="separator:abd583fc16be734520d00bf77847a7d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e166f629644b6241385a493229f108b"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a6e166f629644b6241385a493229f108b">prepareSvGet</a> (const <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso_1_1transaction.html#a76af9bccbd6cc00f3122c80487d3c99c">SvOperation</a> svOperation, const <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso_1_1transaction.html#a0c82c702b58c7330bcecc0f098bcf1ca">SvAction</a> svAction)=0</td></tr>
<tr class="separator:a6e166f629644b6241385a493229f108b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4181475a32748e7ab31d9dd6f6a23de6"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a4181475a32748e7ab31d9dd6f6a23de6">prepareSvReload</a> (const int amount, const std::vector&lt; uint8_t &gt; &amp;date, const std::vector&lt; uint8_t &gt; &amp;time, const std::vector&lt; uint8_t &gt; &amp;free)=0</td></tr>
<tr class="separator:a4181475a32748e7ab31d9dd6f6a23de6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98d036f7ed3b25b1c390f232acb3cad6"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a98d036f7ed3b25b1c390f232acb3cad6">prepareSvReload</a> (const int amount)=0</td></tr>
<tr class="separator:a98d036f7ed3b25b1c390f232acb3cad6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae12af2bb2f454b65597284ac8570f93a"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ae12af2bb2f454b65597284ac8570f93a">prepareSvDebit</a> (const int amount, const std::vector&lt; uint8_t &gt; &amp;date, const std::vector&lt; uint8_t &gt; &amp;time)=0</td></tr>
<tr class="separator:ae12af2bb2f454b65597284ac8570f93a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2bd54dfcc17dab9df200fc6ed052a3f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ac2bd54dfcc17dab9df200fc6ed052a3f">prepareSvDebit</a> (const int amount)=0</td></tr>
<tr class="separator:ac2bd54dfcc17dab9df200fc6ed052a3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb9769debfda5d2c7598dff546384ad"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a2cb9769debfda5d2c7598dff546384ad">prepareSvReadAllLogs</a> ()=0</td></tr>
<tr class="separator:a2cb9769debfda5d2c7598dff546384ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d9f8df48aa075f55dff2b8bd11786ec"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a9d9f8df48aa075f55dff2b8bd11786ec">prepareInvalidate</a> ()=0</td></tr>
<tr class="separator:a9d9f8df48aa075f55dff2b8bd11786ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a166b74ab4b19bc1c9b1b2b1d7d203ebc"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a166b74ab4b19bc1c9b1b2b1d7d203ebc">prepareRehabilitate</a> ()=0</td></tr>
<tr class="separator:a166b74ab4b19bc1c9b1b2b1d7d203ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2021f9af1caa81ef125d48007e5b0e5"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ac2021f9af1caa81ef125d48007e5b0e5">prepareReleaseCardChannel</a> ()=0</td></tr>
<tr class="separator:ac2021f9af1caa81ef125d48007e5b0e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f2b7a1d97efde3898b516dd810e848e"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a2f2b7a1d97efde3898b516dd810e848e">processCardCommands</a> ()=0</td></tr>
<tr class="separator:a2f2b7a1d97efde3898b516dd810e848e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1698ec8d5bcc6c1c44c72cee5d21165"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#af1698ec8d5bcc6c1c44c72cee5d21165">processVerifyPin</a> (const std::vector&lt; uint8_t &gt; &amp;pin)=0</td></tr>
<tr class="separator:af1698ec8d5bcc6c1c44c72cee5d21165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2501b28292232667b71ada5177c2dc3"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad2501b28292232667b71ada5177c2dc3">processChangePin</a> (const std::vector&lt; uint8_t &gt; &amp;newPin)=0</td></tr>
<tr class="separator:ad2501b28292232667b71ada5177c2dc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6375c0ed4ce2bdb739e89070582e6d25"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a6375c0ed4ce2bdb739e89070582e6d25">processChangeKey</a> (const uint8_t keyIndex, const uint8_t newKif, const uint8_t newKvc, const uint8_t issuerKif, const uint8_t issuerKvc)=0</td></tr>
<tr class="separator:a6375c0ed4ce2bdb739e89070582e6d25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a219bce34cc30b755709a65934d05ae9f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a219bce34cc30b755709a65934d05ae9f">processOpening</a> (const <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso.html#a159cc27ed6f503baf59f58b875b7ca71">WriteAccessLevel</a> writeAccessLevel)=0</td></tr>
<tr class="separator:a219bce34cc30b755709a65934d05ae9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad40866c6ce1ec0618570dab40dca6886"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing</a> ()=0</td></tr>
<tr class="separator:ad40866c6ce1ec0618570dab40dca6886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceaed7bd2b1aa9bfab64fcda7bd4502f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#aceaed7bd2b1aa9bfab64fcda7bd4502f">processCancel</a> ()=0</td></tr>
<tr class="separator:aceaed7bd2b1aa9bfab64fcda7bd4502f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html">calypsonet::terminal::calypso::transaction::CommonTransactionManager&lt; CardTransactionManager, CardSecuritySetting &gt;</a></td></tr>
<tr class="memitem:abfff2d413e2a3fa3ebce1be777a20846 inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html#abfff2d413e2a3fa3ebce1be777a20846">~CommonTransactionManager</a> ()=default</td></tr>
<tr class="separator:abfff2d413e2a3fa3ebce1be777a20846 inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac40c868f81d25d0d1e0de705fcb19b69 inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memItemLeft" align="right" valign="top">virtual const std::shared_ptr&lt; <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_security_setting.html">CardSecuritySetting</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html#ac40c868f81d25d0d1e0de705fcb19b69">getSecuritySetting</a> () const=0</td></tr>
<tr class="separator:ac40c868f81d25d0d1e0de705fcb19b69 inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05dbf16b51d41c1014709dd708a3e92c inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memItemLeft" align="right" valign="top">virtual const std::vector&lt; std::vector&lt; uint8_t &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html#a05dbf16b51d41c1014709dd708a3e92c">getTransactionAuditData</a> () const=0</td></tr>
<tr class="separator:a05dbf16b51d41c1014709dd708a3e92c inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f294fc65230eaf1fc9dffd329146ef1 inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html#a7f294fc65230eaf1fc9dffd329146ef1">prepareComputeSignature</a> (const any data)=0</td></tr>
<tr class="separator:a7f294fc65230eaf1fc9dffd329146ef1 inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad774a020811514711a307e25d4729801 inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html#ad774a020811514711a307e25d4729801">prepareVerifySignature</a> (const any data)=0</td></tr>
<tr class="separator:ad774a020811514711a307e25d4729801 inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a905f5a2160cdc54b5d2cebf9a01047da inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html#a905f5a2160cdc54b5d2cebf9a01047da">processCommands</a> ()=0</td></tr>
<tr class="separator:a905f5a2160cdc54b5d2cebf9a01047da inherit pub_methods_classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Service providing the high-level API to manage transactions with a Calypso card.</p>
<p >Depending on the type of operations required, the presence of a SAM may be necessary.</p>
<p >The <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> object provided to the build is kept and updated at each step of using the service. It is the main container of the data handled during the transaction and acts as a card image.</p>
<p >There are two main steps in using the methods of this service:</p>
<ul>
<li>
A command preparation step during which the application invokes prefixed "prepare" methods that will add to an internal list of commands to be executed by the card. The incoming data to the card are placed in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a>. </li>
<li>
A processing step corresponding to the prefixed "process" methods, which will carry out the communications with the card and if necessary the SAM. The outgoing data from the card are placed in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a>. </li>
</ul>
<p >Technical or data errors, security conditions, etc. are reported as exceptions.</p>
<p >For all "prepare" type commands, unless otherwise specified, here are the ranges of values checked for the various parameters:</p>
<ul>
<li>
SFI: [0..30] (0 indicates the current EF) </li>
<li>
Record number: [1..250] </li>
<li>
Counter number: [1..83] </li>
<li>
Counter value: [0..16777215] </li>
<li>
Offset: [0..249] or [0..32767] for binary files (0 indicates the first byte) </li>
<li>
Input data length: [1..250] or [1..32767] for binary files </li>
</ul>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="_card_transaction_manager_8h_source.html#l00080">80</a> of file <a class="el" href="_card_transaction_manager_8h_source.html">CardTransactionManager.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a1ec7763db77a1102e6d5cda98892e0fe" name="a1ec7763db77a1102e6d5cda98892e0fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ec7763db77a1102e6d5cda98892e0fe">&#9670;&nbsp;</a></span>getCalypsoCard()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const std::shared_ptr&lt; <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">CalypsoCard</a> &gt; calypsonet::terminal::calypso::transaction::CardTransactionManager::getCalypsoCard </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Gets the target card on which the transaction is performed.</p>
<dl class="section return"><dt>Returns</dt><dd>A not null <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> having a <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#a977dbf4401555fd3ffacb4aca410055e">calypsonet::terminal::calypso::card::CalypsoCard::ProductType</a> different from <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#a977dbf4401555fd3ffacb4aca410055ea696b031073e74bf2cb98e5ef201d4aa3">calypsonet::terminal::calypso::card::CalypsoCard::ProductType::UNKNOWN</a>. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="ab7a3d399c1a5fd0a93ec534203059478" name="ab7a3d399c1a5fd0a93ec534203059478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7a3d399c1a5fd0a93ec534203059478">&#9670;&nbsp;</a></span>getCardReader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const std::shared_ptr&lt; CardReader &gt; calypsonet::terminal::calypso::transaction::CardTransactionManager::getCardReader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Gets the reader used to communicate with the target card on which the transaction is performed.</p>
<dl class="section return"><dt>Returns</dt><dd>A not null reference. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="af09581a52286a3759e39e982f27d04b2" name="af09581a52286a3759e39e982f27d04b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af09581a52286a3759e39e982f27d04b2">&#9670;&nbsp;</a></span>getCardSecuritySetting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const std::shared_ptr&lt; <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_security_setting.html">CardSecuritySetting</a> &gt; calypsonet::terminal::calypso::transaction::CardTransactionManager::getCardSecuritySetting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Gets the settings defining the security parameters of the transaction.</p>
<dl class="section return"><dt>Returns</dt><dd>Null if the transaction does not use security settings. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000006">Deprecated:</a></b></dt><dd>Use <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html#ac40c868f81d25d0d1e0de705fcb19b69">getSecuritySetting()</a> instead. </dd></dl>

</div>
</div>
<a id="a22dda308b73fff151b65ebbdda760fbf" name="a22dda308b73fff151b65ebbdda760fbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22dda308b73fff151b65ebbdda760fbf">&#9670;&nbsp;</a></span>prepareAppendRecord()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareAppendRecord </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>recordData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Append Record</b> command to adds the data provided in the indicated cyclic file.</p>
<p >A new record is added, the oldest record is deleted.</p>
<p >Note: <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> is filled with the provided input data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The sfi to select. </td></tr>
    <tr><td class="paramname">recordData</td><td>The new record data to write. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a9bc9d47aa43eb13dfc9a992f3f42b25a" name="a9bc9d47aa43eb13dfc9a992f3f42b25a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bc9d47aa43eb13dfc9a992f3f42b25a">&#9670;&nbsp;</a></span>prepareCheckPinStatus()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareCheckPinStatus </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Verify Pin</b> command without PIN presentation in order to get the attempt counter.</p>
<p >The PIN status will be made available in CalypsoCard after the execution of process command. <br  />
 Adds it to the list of commands to be sent with the next process command.</p>
<p >See <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#a3eee3b60e1a2a44f3e65d43c567e63a7">calypsonet::terminal::calypso::card::CalypsoCard::isPinBlocked()</a> and <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#a048f525507eda29bd9d53503fbd759a3">calypsonet::terminal::calypso::card::CalypsoCard::getPinAttemptRemaining()</a> methods.</p>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If the PIN feature is not available for this card. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a0dee576191d3fcf8faefd03d8d15d198" name="a0dee576191d3fcf8faefd03d8d15d198"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dee576191d3fcf8faefd03d8d15d198">&#9670;&nbsp;</a></span>prepareDecreaseCounter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareDecreaseCounter </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>counterNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>decValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Increase Multiple</b> command to increase multiple target counters at the same time.</p>
<p >Note 1: CalypsoCard is updated with the provided input data.</p>
<p >Note 2: in the case where this method is invoked before the invocation of <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a>, the counter must have been read previously otherwise an IllegalStateException} will be raised during the execution of <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>SFI of the EF to select. </td></tr>
    <tr><td class="paramname">counterNumber</td><td>The number of the counter (must be zero in case of a simulated counter). </td></tr>
    <tr><td class="paramname">decValue</td><td>Value to subtract to the counter (defined as a positive int <div class="fragment"><div class="line">&lt;= </div>
</div><!-- fragment --> 16777215 [FFFFFFh]) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="afa4423d44184d71297ea741f46f68998" name="afa4423d44184d71297ea741f46f68998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa4423d44184d71297ea741f46f68998">&#9670;&nbsp;</a></span>prepareDecreaseCounters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareDecreaseCounters </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const int, const int &gt; &amp;&#160;</td>
          <td class="paramname"><em>counterNumberToDecValueMap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Decrease Multiple</b> command to decrease multiple target counters at the same time.</p>
<p >Note 1: CalypsoCard is updated with the provided input data.</p>
<p >Note 2: in the case where this method is invoked before the invocation of <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a>, the counter must have been read previously otherwise an IllegalStateException} will be raised during the execution of <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>SFI of the EF to select. </td></tr>
    <tr><td class="paramname">counterNumberToDecValueMap</td><td>The map containing the counter numbers to be decremented and their associated decrement values. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If the decrease multiple command is not available for this card. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range or if the map is null or empty. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="a02415c131fec75b6d2b00347e5c07103" name="a02415c131fec75b6d2b00347e5c07103"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02415c131fec75b6d2b00347e5c07103">&#9670;&nbsp;</a></span>prepareGetData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareGetData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso.html#adfb916965f55ec8780fe2dba24db3bff">GetDataTag</a>&#160;</td>
          <td class="paramname"><em>tag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Adds a command APDU to retrieve the data indicated by the provided tag.</p>
<p >The data returned by the command is used to update the current <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tag</td><td>The tag to use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The object instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If the Get Data command with the provided tag is not supported. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If tag is null. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="aafda6939a220c0877d8732e3d3ccbd65" name="aafda6939a220c0877d8732e3d3ccbd65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafda6939a220c0877d8732e3d3ccbd65">&#9670;&nbsp;</a></span>prepareIncreaseCounter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareIncreaseCounter </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>counterNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>incValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Increase</b> command to increase the target counter.</p>
<p >Note 1: CalypsoCard is updated with the provided input data.</p>
<p >Note 2: in the case where this method is invoked before the invocation of <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a>, the counter must have been read previously otherwise an IllegalStateException will be raised during the execution of <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>SFI of the EF to select. </td></tr>
    <tr><td class="paramname">counterNumber</td><td>The number of the counter (must be zero in case of a simulated counter). </td></tr>
    <tr><td class="paramname">incValue</td><td>Value to add to the counter (defined as a positive int <div class="fragment"><div class="line">&lt;= </div>
</div><!-- fragment --> 16777215 [FFFFFFh]) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="aed6e60678ad82ee11011827a53befbfc" name="aed6e60678ad82ee11011827a53befbfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed6e60678ad82ee11011827a53befbfc">&#9670;&nbsp;</a></span>prepareIncreaseCounters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareIncreaseCounters </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const int, const int &gt; &amp;&#160;</td>
          <td class="paramname"><em>counterNumberToIncValueMap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Increase Multiple</b> command to increase multiple target counters at the same time.</p>
<p >Note 1: CalypsoCard is updated with the provided input data.</p>
<p >Note 2: in the case where this method is invoked before the invocation of <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a>, the counter must have been read previously otherwise an IllegalStateException will be raised during the execution of <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>SFI of the EF to select. </td></tr>
    <tr><td class="paramname">counterNumberToIncValueMap</td><td>The map containing the counter numbers to be incremented and their associated increment values. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If the increase multiple command is not available for this card. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range or if the map is null or empty. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="a9d9f8df48aa075f55dff2b8bd11786ec" name="a9d9f8df48aa075f55dff2b8bd11786ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d9f8df48aa075f55dff2b8bd11786ec">&#9670;&nbsp;</a></span>prepareInvalidate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareInvalidate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Invalidate</b> command.</p>
<p >This command is usually executed within a secure session with the DEBIT key (depends on the access rights given to this command in the file structure of the card).</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalStateException</td><td>If the card is already invalidated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="afb0dadeb585b832731cf6cadf4e80a30" name="afb0dadeb585b832731cf6cadf4e80a30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb0dadeb585b832731cf6cadf4e80a30">&#9670;&nbsp;</a></span>prepareReadBinary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareReadBinary </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nbBytesToRead</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of one or multiple <b>Read Binary</b> commands to read all or part of the indicated Binary EF.</p>
<p >Once this command is processed, the result is available in CalypsoCard.</p>
<p >Depending on whether we are inside a secure session, there are two types of behavior following this command:</p>
<ul>
<li>
Outside a secure session (best effort mode): the following "process" command will not fail whatever the existence of the targeted file or the validity of the offset and number of bytes to read (the CalypsoCard object may not be filled). </li>
<li>
Inside a secure session (strict mode): the following "process" command will fail if the targeted file does not exist or if the offset and number of bytes to read are not valid (the CalypsoCard object is always filled or an exception is raised when the reading failed).<br  />
 Invalid parameters could lead to additional exchanges with the card and thus corrupt the security of the session. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The SFI of the EF. </td></tr>
    <tr><td class="paramname">offset</td><td>The offset (0 indicates the first byte). </td></tr>
    <tr><td class="paramname">nbBytesToRead</td><td>The number of bytes to read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If this command is not supported by this card. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="a8d4a52b014aa766504f0d60f43b92c08" name="a8d4a52b014aa766504f0d60f43b92c08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d4a52b014aa766504f0d60f43b92c08">&#9670;&nbsp;</a></span>prepareReadCounter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareReadCounter </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nbCountersToRead</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Read Records</b> command to reads a record of the indicated EF, which should be a counter file.</p>
<p >The record will be read up to the counter location indicated in parameter.<br  />
 Thus, all previous counters will also be read.</p>
<p >Once this command is processed, the result is available in CalypsoCard.</p>
<p >Depending on whether we are inside a secure session, there are two types of behavior following this command:</p>
<ul>
<li>
Outside a secure session (best effort mode): the following "process" command will not fail whatever the existence of the targeted file or counter (the CalypsoCard object may not be filled). </li>
<li>
Inside a secure session (strict mode): the following "process" command will fail if the targeted file or counter does not exist (the CalypsoCard object is always filled or an exception is raised when the reading failed).<br  />
 Invalid parameters could lead to additional exchanges with the card and thus corrupt the security of the session. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The SFI of the EF. </td></tr>
    <tr><td class="paramname">nbCountersToRead</td><td>The number of counters to read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="ae537c2cf99e118c9b6b719fc465b3370" name="ae537c2cf99e118c9b6b719fc465b3370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae537c2cf99e118c9b6b719fc465b3370">&#9670;&nbsp;</a></span>prepareReadCounterFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareReadCounterFile </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>countersNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Read Records</b> command to reads a record of the indicated EF, which should be a counter file.</p>
<p >The record will be read up to the counter location indicated in parameter.<br  />
 Thus, all previous counters will also be read.</p>
<p >Once this command is processed, the result is available in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a>.</p>
<p >Depending on whether we are inside a secure session, there are two types of behavior following this command:</p>
<ul>
<li>
Outside a secure session (best effort mode): the following "process" command will not fail whatever the existence of the targeted file or counter (the CalypsoCard object may not be filled). </li>
<li>
Inside a secure session (strict mode): the following "process" command will fail if the targeted file or counter does not exist (the CalypsoCard object is always filled or an exception is raised when the reading failed).<br  />
 Invalid parameters could lead to additional exchanges with the card and thus corrupt the security of the session. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The SFI of the EF. </td></tr>
    <tr><td class="paramname">countersNumber</td><td>The number of the last counter to be read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000010">Deprecated:</a></b></dt><dd>Use prepareReadCounter(const uint8_t, const int) method instead. </dd></dl>

</div>
</div>
<a id="ad945048d3ffb7cb8b75ea137d5d68dbe" name="ad945048d3ffb7cb8b75ea137d5d68dbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad945048d3ffb7cb8b75ea137d5d68dbe">&#9670;&nbsp;</a></span>prepareReadRecord()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareReadRecord </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>recordNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Read Records</b> command to read a single record from the indicated EF.</p>
<p >Once this command is processed, the result is available in CalypsoCard.</p>
<p >Depending on whether we are inside a secure session, there are two types of behavior following this command:</p>
<ul>
<li>
Outside a secure session (best effort mode): the following "process" command will not fail whatever the existence of the targeted file or record (the CalypsoCard object may not be filled). </li>
<li>
Inside a secure session in contactless mode (strict mode): the following "process" command will fail if the targeted file or record does not exist (the CalypsoCard object is always filled or an exception is raised when the reading failed). </li>
</ul>
<p ><b>This method should not be used inside a secure session in contact mode</b> because additional exchanges with the card will be operated and will corrupt the security of the session. Instead, use the method prepareReadRecordFile(const uint8_t, const int, const int, const int) for this case and provide valid parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The SFI of the EF to read. </td></tr>
    <tr><td class="paramname">recordNumber</td><td>The record to read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided arguments is out of range. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>If this method is invoked inside a secure session in contact mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="a5fdc266749359d06709637515974c387" name="a5fdc266749359d06709637515974c387"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fdc266749359d06709637515974c387">&#9670;&nbsp;</a></span>prepareReadRecordFile() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareReadRecordFile </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>firstRecordNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>numberOfRecords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>recordSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Read Records</b> command to read one or more records from the indicated EF.</p>
<p >Once this command is processed, the result is available in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a>.</p>
<p >Depending on whether we are inside a secure session, there are two types of behavior following this command:</p>
<ul>
<li>
Outside a secure session (best effort mode): the following "process" command will not fail whatever the existence of the targeted file or record (the <a class="el" href="">CalypsoCard</a> object may not be filled). </li>
<li>
Inside a secure session (strict mode): the following "process" command will fail if the targeted file or record does not exist (the <a class="el" href="">CalypsoCard</a> object is always filled or an exception is raised when the reading failed).<br  />
 Invalid parameters could lead to additional exchanges with the card and thus corrupt the security of the session. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The SFI of the EF. </td></tr>
    <tr><td class="paramname">firstRecordNumber</td><td>The record to read (or first record to read in case of several records) </td></tr>
    <tr><td class="paramname">numberOfRecords</td><td>The number of records expected. </td></tr>
    <tr><td class="paramname">recordSize</td><td>The record length. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000009">Deprecated:</a></b></dt><dd>Use prepareReadRecords(const uint8_t, const int, const int, const int) method instead. </dd></dl>

</div>
</div>
<a id="a81adf09121b6d8de19bb0bd456754df3" name="a81adf09121b6d8de19bb0bd456754df3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81adf09121b6d8de19bb0bd456754df3">&#9670;&nbsp;</a></span>prepareReadRecordFile() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareReadRecordFile </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>recordNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Read Records</b> command to read a single record from the indicated EF.</p>
<p >Once this command is processed, the result is available in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a>.</p>
<p >Depending on whether we are inside a secure session, there are two types of behavior following this command:</p>
<ul>
<li>
Outside a secure session (best effort mode): the following "process" command will not fail whatever the existence of the targeted file or record (the CalypsoCard object may not be filled). </li>
<li>
Inside a secure session in contactless mode (strict mode): the following "process" command will fail if the targeted file or record does not exist (the CalypsoCard object is always filled or an exception is raised when the reading failed). </li>
</ul>
<p ><b>This method should not be used inside a secure session in contact mode</b> because additional exchanges with the card will be operated and will corrupt the security of the session. Instead, use the method prepareReadRecordFile(byte, int, int, int) for this case and provide valid parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The SFI of the EF to read. </td></tr>
    <tr><td class="paramname">recordNumber</td><td>The record to read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided arguments is out of range. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>If this method is invoked inside a secure session in contact mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000008">Deprecated:</a></b></dt><dd>Use prepareReadRecords(const uint8_t, const int) method instead. </dd></dl>

</div>
</div>
<a id="ae5c992dc5952de139b25c68081931593" name="ae5c992dc5952de139b25c68081931593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5c992dc5952de139b25c68081931593">&#9670;&nbsp;</a></span>prepareReadRecords()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareReadRecords </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>fromRecordNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>toRecordNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>recordSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Read Records</b> command to read one or more records from the indicated EF.</p>
<p >Once this command is processed, the result is available in CalypsoCard.</p>
<p >Depending on whether we are inside a secure session, there are two types of behavior following this command:</p>
<ul>
<li>
Outside a secure session (best effort mode): the following "process" command will not fail whatever the existence of the targeted file or record (the CalypsoCard object may not be filled). </li>
<li>
Inside a secure session (strict mode): the following "process" command will fail if the targeted file or record does not exist (the CalypsoCard object is always filled or an exception is raised when the reading failed).<br  />
 Invalid parameters could lead to additional exchanges with the card and thus corrupt the security of the session. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The SFI of the EF. </td></tr>
    <tr><td class="paramname">fromRecordNumber</td><td>The number of the first record to read. </td></tr>
    <tr><td class="paramname">toRecordNumber</td><td>The number of the last record to read. </td></tr>
    <tr><td class="paramname">recordSize</td><td>The record length. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="ad2c1a93fca710b0af2291c3a465e1bb4" name="ad2c1a93fca710b0af2291c3a465e1bb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2c1a93fca710b0af2291c3a465e1bb4">&#9670;&nbsp;</a></span>prepareReadRecordsPartially()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareReadRecordsPartially </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>fromRecordNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>toRecordNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>nbBytesToRead</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of one or multiple <b>Read Record Multiple</b> commands to read all or parts of multiple records of the indicated EF.</p>
<p >Once this command is processed, the result is available in CalypsoCard.</p>
<p >Depending on whether we are inside a secure session, there are two types of behavior following this command:</p>
<ul>
<li>
Outside a secure session (best effort mode): the following "process" command will not fail whatever the existence of the targeted file or the validity of the offset and number of bytes to read (the CalypsoCard object may not be filled). </li>
<li>
Inside a secure session (strict mode): the following "process" command will fail if the targeted file does not exist or if the offset and number of bytes to read are not valid (the CalypsoCard object is always filled or an exception is raised when the reading failed).<br  />
 Invalid parameters could lead to additional exchanges with the card and thus corrupt the security of the session. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The SFI of the EF. </td></tr>
    <tr><td class="paramname">fromRecordNumber</td><td>The number of the first record to read. </td></tr>
    <tr><td class="paramname">toRecordNumber</td><td>The number of the last record to read. </td></tr>
    <tr><td class="paramname">offset</td><td>The offset in the records where to start reading (0 indicates the first byte). </td></tr>
    <tr><td class="paramname">nbBytesToRead</td><td>The number of bytes to read from each record. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If this command is not supported by this card. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="a166b74ab4b19bc1c9b1b2b1d7d203ebc" name="a166b74ab4b19bc1c9b1b2b1d7d203ebc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a166b74ab4b19bc1c9b1b2b1d7d203ebc">&#9670;&nbsp;</a></span>prepareRehabilitate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareRehabilitate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Rehabilitate</b> command.</p>
<p >This command is usually executed within a secure session with the PERSONALIZATION key (depends on the access rights given to this command in the file structure of the card).</p>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalStateException</td><td>If the card is not invalidated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="ac2021f9af1caa81ef125d48007e5b0e5" name="ac2021f9af1caa81ef125d48007e5b0e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2021f9af1caa81ef125d48007e5b0e5">&#9670;&nbsp;</a></span>prepareReleaseCardChannel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareReleaseCardChannel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Requests the closing of the card channel.</p>
<p >If this command is called before a "process" command (except for processOpening) then the last transmission to the card will be associated with the indication CLOSE_AFTER in order to close the card channel.</p>
<p >Note: this command must imperatively be called at the end of any transaction, whether it ended normally or not.</p>
<p >In case the transaction was interrupted (exception), an additional invocation of processCardCommands must be made to effectively close the channel.</p>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a38887edb3ac6110c3d0e831c71707475" name="a38887edb3ac6110c3d0e831c71707475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38887edb3ac6110c3d0e831c71707475">&#9670;&nbsp;</a></span>prepareSearchRecords()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSearchRecords </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_search_command_data.html">SearchCommandData</a> &gt;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Search Record Multiple</b> command to search data in the records of the indicated EF, from a given record to the last record of the file. It will return the list of record numbers containing these data, and if requested it will read the first record content.</p>
<p >The command is only possible with a Linear, Cyclic, Counters or Simulated Counter EF.</p>
<p >The command searches if the given data are present in the records of the file. During the search, an optional mask is applied. The mask allows to specify precisely the bits to be taken into account in the comparison.</p>
<p >See <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_search_command_data.html">SearchCommandData</a> class for a description of the parameters.</p>
<p >Once this command is processed, the result is available in the provided input/output <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_search_command_data.html">SearchCommandData</a> object, and the content of the first matching record in CalypsoCard if requested.</p>
<p >Depending on whether we are inside a secure session, there are two types of behavior following this command:</p>
<ul>
<li>
Outside a secure session (best effort mode): the following "process" command will not fail whatever the existence of the targeted file or the validity of the record number and offset (the <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_search_command_data.html">SearchCommandData</a> and CalypsoCard objects may not be updated). </li>
<li>
Inside a secure session (strict mode): the following "process" command will fail if the targeted file does not exist or if the record number and the offset are not valid (the <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_search_command_data.html">SearchCommandData</a> and CalypsoCard objects are always filled or an exception is raised when the reading failed). </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>The input/output data containing the parameters of the command. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If the "Search Record Multiple" command is not available for this card. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If the input data is inconsistent. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_search_command_data.html">SearchCommandData</a> </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="a68497bf751b092696e9ab6eded82f1da" name="a68497bf751b092696e9ab6eded82f1da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68497bf751b092696e9ab6eded82f1da">&#9670;&nbsp;</a></span>prepareSelectFile() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSelectFile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso.html#ab3b5c5c0a3d6688a55ea7cab10d0d748">SelectFileControl</a>&#160;</td>
          <td class="paramname"><em>selectFileControl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Select File</b> command using a navigation selectFileControl defined by the ISO standard.</p>
<p >Once this command is processed, the result is available in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> through the <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_elementary_file.html#a32fef5101c296e9e52138ffa23c56a0d">ElementaryFile::getHeader()</a> methods.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selectFileControl</td><td>A calypsonet::terminal::calypso::card::SelectFileControl enum entry. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If selectFileControl is null. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a299841a2f10ac38926daddce25958e0e" name="a299841a2f10ac38926daddce25958e0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299841a2f10ac38926daddce25958e0e">&#9670;&nbsp;</a></span>prepareSelectFile() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSelectFile </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>lid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Select File</b> command based on the file's LID.</p>
<p >Once this command is processed, the result is available in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> through the CalypsoCard::getFileBySfi(byte)/CalypsoCard#getFileByLid(short) and <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_elementary_file.html#a32fef5101c296e9e52138ffa23c56a0d">ElementaryFile::getHeader()</a> methods.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lid</td><td>The LID of the EF to select. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If the provided lid is not 2 bytes long. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000007">Deprecated:</a></b></dt><dd>Use <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a5a58e196deea760cba8be392574b1cf7">prepareSelectFile(uint16_t)</a> method instead. </dd></dl>

</div>
</div>
<a id="a5a58e196deea760cba8be392574b1cf7" name="a5a58e196deea760cba8be392574b1cf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a58e196deea760cba8be392574b1cf7">&#9670;&nbsp;</a></span>prepareSelectFile() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSelectFile </td>
          <td>(</td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>lid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Select File</b> command to select an EF by its LID in the current DF</p>
<p >Once this command is processed, the result is available in CalypsoCard through the CalypsoCard::getFileBySfi(byte)/CalypsoCard#getFileByLid(short) and <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_elementary_file.html#a32fef5101c296e9e52138ffa23c56a0d">ElementaryFile::getHeader()</a> methods.</p>
<p >Caution: the command will fail if the selected file is not an EF.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lid</td><td>The LID of the EF to select. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="abd583fc16be734520d00bf77847a7d0b" name="abd583fc16be734520d00bf77847a7d0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd583fc16be734520d00bf77847a7d0b">&#9670;&nbsp;</a></span>prepareSetCounter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSetCounter </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>counterNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>newValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a command to set the value of the target counter.</p>
<p >It builds an Increase or Decrease command and add it to the list of commands to be sent with the next <b>process</b> command in order to set the target counter to the specified value.<br  />
 The operation (Increase or Decrease) is selected according to whether the difference between the current value and the desired value is negative (Increase) or positive (Decrease).</p>
<p >Note: it is assumed here that:<br  />
</p>
<ul>
<li>
the counter value has been read before, </li>
<li>
the type of session (and associated access rights) is consistent with the requested operation: reload session if the counter is to be incremented, debit if it is to be decremented.<br  />
 No control is performed on this point by this method; the closing of the session will determine the success of the operation.. </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">counterNumber</td><td><div class="fragment"><div class="line">&gt;= </div>
</div><!-- fragment --> 1: Counters file, number of the counter. 0: Simulated. Counter file. </td></tr>
    <tr><td class="paramname">sfi</td><td>SFI of the EF to select. </td></tr>
    <tr><td class="paramname">newValue</td><td>The desired value for the counter (defined as a positive int <div class="fragment"><div class="line">&lt;= </div>
</div><!-- fragment --> 16777215 [FFFFFFh]) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>If the current counter value is unknown. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="ac2bd54dfcc17dab9df200fc6ed052a3f" name="ac2bd54dfcc17dab9df200fc6ed052a3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2bd54dfcc17dab9df200fc6ed052a3f">&#9670;&nbsp;</a></span>prepareSvDebit() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSvDebit </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>amount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>SV Debit</b> or <b>SV Undebit</b> command to increase the current SV balance or to partially or totally cancels the last SV debit command.</p>
<p >It consists in decreasing the current balance of the SV by a certain amount or canceling a previous debit.</p>
<p >Note #1: the optional SV additional data are set to zero.</p>
<p >Note #2: a communication with the SAM is done here.</p>
<p >Note #3: the key used is the reload key.The information fields such as date and time are set to 0. The extraInfo field propagated in Logs are automatically generated with the type of transaction and amount.</p>
<p >Note #4: operations that would result in a negative balance are forbidden (SV Exception raised).</p>
<p >Note #5: the key used is the debit key</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">amount</td><td>The amount to be subtracted or added, positive integer in the range 0..32767 when subtracted and 0..32768 when added. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>In one of the following cases: <ul>
<li>
New value is negative and negative balances are not allowed. </li>
<li>
Another SV command was already prepared inside the same secure session. </li>
<li>
The SV command is not placed in the first position in the list of prepared commands. </li>
<li>
The SV command does not follow a "SV Get" command. </li>
<li>
The command and the SV operation are not consistent. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="ae12af2bb2f454b65597284ac8570f93a" name="ae12af2bb2f454b65597284ac8570f93a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae12af2bb2f454b65597284ac8570f93a">&#9670;&nbsp;</a></span>prepareSvDebit() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSvDebit </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>amount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>SV Debit</b> or <b>SV Undebit</b> command to increase the current SV balance or to partially or totally cancels the last SV debit command and using the provided additional data.</p>
<p >It consists in decreasing the current balance of the SV by a certain amount or canceling a previous debit according to the type operation chosen in when invoking the previous SV Get command.</p>
<p >Note #1: a communication with the SAM is done here.</p>
<p >Note #2: the key used is the reload key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">amount</td><td>The amount to be subtracted or added, positive integer in the range 0..32767 when subtracted and 0..32768 when added. </td></tr>
    <tr><td class="paramname">date</td><td>2-byte free value. </td></tr>
    <tr><td class="paramname">time</td><td>2-byte free value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>In one of the following cases: <ul>
<li>
New value is negative and negative balances are not allowed. </li>
<li>
Another SV command was already prepared inside the same secure session. </li>
<li>
The SV command is not placed in the first position in the list of prepared commands. </li>
<li>
The SV command does not follow a "SV Get" command. </li>
<li>
The command and the SV operation are not consistent. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a6e166f629644b6241385a493229f108b" name="a6e166f629644b6241385a493229f108b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e166f629644b6241385a493229f108b">&#9670;&nbsp;</a></span>prepareSvGet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSvGet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso_1_1transaction.html#a76af9bccbd6cc00f3122c80487d3c99c">SvOperation</a>&#160;</td>
          <td class="paramname"><em>svOperation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso_1_1transaction.html#a0c82c702b58c7330bcecc0f098bcf1ca">SvAction</a>&#160;</td>
          <td class="paramname"><em>svAction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>SV Get</b> command to prepare an SV operation or simply retrieves the current SV status.</p>
<p >Once this command is processed, the result is available in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a>.</p>
<p >See the methods <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#a27262b8a18598ecb02f922b2a62695c1">CalypsoCard::getSvBalance()</a>, <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#a421184b28ed2b0141debecafb530885c">CalypsoCard::getSvLoadLogRecord()</a>, <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#ad6cc441472cfa10c8efcb134b0e9e2d3">CalypsoCard::getSvDebitLogLastRecord()</a>, <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#ac1167e9e46142167e3782c141b56b99b">CalypsoCard::getSvDebitLogAllRecords()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">svOperation</td><td>Informs about the nature of the intended operation: debit or reload. </td></tr>
    <tr><td class="paramname">svAction</td><td>The type of action: DO a debit or a positive reload, UNDO an undebit or a. negative reload </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If the SV feature is not available for this card. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the arguments is null. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a2cb9769debfda5d2c7598dff546384ad" name="a2cb9769debfda5d2c7598dff546384ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb9769debfda5d2c7598dff546384ad">&#9670;&nbsp;</a></span>prepareSvReadAllLogs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSvReadAllLogs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of <b>Read Records</b> commands to read all SV logs.</p>
<p >Note: this method requires that the selected application is of type Store Value (file structure 20h).</p>
<p >The SV transaction logs are contained in two files with fixed identifiers:</p>
<ul>
<li>
The file whose SFI is 14h contains 1 record containing the unique reload log. </li>
<li>
The file whose SFI is 15h contains 3 records containing the last three debit logs. </li>
</ul>
<p >At the end of this reading operation, the data will be accessible in CalypsoCard in raw format via the standard commands for accessing read files or in the form of dedicated objects (see <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#a421184b28ed2b0141debecafb530885c">calypsonet::terminal::calypso::card::CalypsoCard::getSvLoadLogRecord()</a> and <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#ac1167e9e46142167e3782c141b56b99b">calypsonet::terminal::calypso::card::CalypsoCard::getSvDebitLogAllRecords()</a>)</p>
<p >At the end of this reading operation, the data will be accessible in CalypsoCard in raw format via the standard commands for accessing read files or in the form of dedicated objects (see <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#a421184b28ed2b0141debecafb530885c">CalypsoCard::getSvLoadLogRecord()</a> and <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#ac1167e9e46142167e3782c141b56b99b">CalypsoCard::getSvDebitLogAllRecords()</a>).</p>
<p >See the methods <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#a27262b8a18598ecb02f922b2a62695c1">CalypsoCard::getSvBalance()</a>, <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#a421184b28ed2b0141debecafb530885c">CalypsoCard::getSvLoadLogRecord()</a>, <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#ad6cc441472cfa10c8efcb134b0e9e2d3">CalypsoCard::getSvDebitLogLastRecord()</a>, <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html#ac1167e9e46142167e3782c141b56b99b">CalypsoCard::getSvDebitLogAllRecords()</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If the application is not of type Stored Value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a98d036f7ed3b25b1c390f232acb3cad6" name="a98d036f7ed3b25b1c390f232acb3cad6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98d036f7ed3b25b1c390f232acb3cad6">&#9670;&nbsp;</a></span>prepareSvReload() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSvReload </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>amount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>SV Reload</b> command to increase the current SV balance.</p>
<p >Note #1: the optional SV additional data are set to zero.</p>
<p >Note #2: a communication with the SAM is done here.</p>
<p >Note #3: the key used is the reload key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">amount</td><td>The value to be reloaded, positive integer in the range 0..8388607 for a DO. action, in the range 0..8388608 for an UNDO action. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If the provided argument is out of range. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>In one of the following cases: <ul>
<li>
Another SV command was already prepared inside the same secure session. </li>
<li>
The SV command is not placed in the first position in the list of prepared commands. </li>
<li>
The SV command does not follow a "SV Get" command. </li>
<li>
The command and the SV operation are not consistent. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a4181475a32748e7ab31d9dd6f6a23de6" name="a4181475a32748e7ab31d9dd6f6a23de6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4181475a32748e7ab31d9dd6f6a23de6">&#9670;&nbsp;</a></span>prepareSvReload() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareSvReload </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>amount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>date</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>free</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>SV Reload</b> command to increase the current SV balance and using the provided additional data.</p>
<p >Note #1: a communication with the SAM is done here.</p>
<p >Note #2: the key used is the reload key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">amount</td><td>The value to be reloaded, positive or negative integer in the range. -8388608..8388607 </td></tr>
    <tr><td class="paramname">date</td><td>2-byte free value. </td></tr>
    <tr><td class="paramname">time</td><td>2-byte free value. </td></tr>
    <tr><td class="paramname">free</td><td>2-byte free value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>In one of the following cases: <ul>
<li>
Another SV command was already prepared inside the same secure session. </li>
<li>
The SV command is not placed in the first position in the list of prepared commands. </li>
<li>
The SV command does not follow a "SV Get" command. </li>
<li>
The command and the SV operation are not consistent. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a580630654d58b1f5e0487b4802925450" name="a580630654d58b1f5e0487b4802925450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a580630654d58b1f5e0487b4802925450">&#9670;&nbsp;</a></span>prepareUpdateBinary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareUpdateBinary </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Update Binary</b> command to replace the indicated data of a Binary file with the new data given from the indicated offset.</p>
<p >The data of the file before the offset and after the data given are left unchanged.</p>
<p >Note: CalypsoCard is filled with the provided input data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The SFI of the EF to select. </td></tr>
    <tr><td class="paramname">offset</td><td>The offset (0 indicates the first byte). </td></tr>
    <tr><td class="paramname">data</td><td>The new data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If this command is not supported by this card. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="af2359a27dfe5d4bfca411dc6b55f29f9" name="af2359a27dfe5d4bfca411dc6b55f29f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2359a27dfe5d4bfca411dc6b55f29f9">&#9670;&nbsp;</a></span>prepareUpdateRecord()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareUpdateRecord </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>recordNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>recordData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Update Record</b> command to overwrites the target file's record contents with the provided data.</p>
<p >If the input data is shorter than the record size, only the first bytes will be overwritten.</p>
<p >Note: <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> is filled with the provided input data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The sfi to select. </td></tr>
    <tr><td class="paramname">recordNumber</td><td>The record to update. </td></tr>
    <tr><td class="paramname">recordData</td><td>The new record data. If length <div class="fragment"><div class="line">&lt;</div>
</div><!-- fragment --> RecSize, bytes beyond length are left unchanged. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a18934a399c7f4ce96c9a45cc80c8ebef" name="a18934a399c7f4ce96c9a45cc80c8ebef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18934a399c7f4ce96c9a45cc80c8ebef">&#9670;&nbsp;</a></span>prepareWriteBinary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareWriteBinary </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Write Binary</b> command to write over the indicated data of a Binary file. The new data will be the result of a binary OR operation between the existing data and the data given in the command from the indicated offset.</p>
<p >The data of the file before the offset and after the data given are left unchanged.</p>
<p >Note: CalypsoCard is computed with the provided input data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The SFI of the EF to select. </td></tr>
    <tr><td class="paramname">offset</td><td>The offset (0 indicates the first byte). </td></tr>
    <tr><td class="paramname">data</td><td>The data to write over the existing data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If this command is not supported by this card. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="a7e76775f5506b0d72ec15ab30c5bb457" name="a7e76775f5506b0d72ec15ab30c5bb457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e76775f5506b0d72ec15ab30c5bb457">&#9670;&nbsp;</a></span>prepareWriteRecord()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::prepareWriteRecord </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>sfi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>recordNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>recordData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Schedules the execution of a <b>Write Record</b> command to updates the target file's record contents with the result of a binary OR between the existing data and the provided data.</p>
<p >If the input data is shorter than the record size, only the first bytes will be overwritten.</p>
<p >Note: <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> is filled with the provided input data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfi</td><td>The sfi to select. </td></tr>
    <tr><td class="paramname">recordNumber</td><td>The record to write. </td></tr>
    <tr><td class="paramname">recordData</td><td>The data to overwrite in the record. If length <div class="fragment"><div class="line">&lt;</div>
</div><!-- fragment --> RecSize, bytes. beyond length are left unchanged. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If one of the provided argument is out of range. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="aceaed7bd2b1aa9bfab64fcda7bd4502f" name="aceaed7bd2b1aa9bfab64fcda7bd4502f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceaed7bd2b1aa9bfab64fcda7bd4502f">&#9670;&nbsp;</a></span>processCancel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::processCancel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Aborts a Secure Session.</p>
<p >Send the appropriate command to the card</p>
<p >Clean up internal data and status.</p>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalStateException</td><td>If no session is open. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_reader_i_o_exception.html">ReaderIOException</a></td><td>If a communication error with the card reader occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_i_o_exception.html">CardIOException</a></td><td>If a communication error with the card occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_unexpected_command_status_exception.html">UnexpectedCommandStatusException</a></td><td>If the command returns an unexpected status. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a2f2b7a1d97efde3898b516dd810e848e" name="a2f2b7a1d97efde3898b516dd810e848e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f2b7a1d97efde3898b516dd810e848e">&#9670;&nbsp;</a></span>processCardCommands()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::processCardCommands </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Process all previously prepared card commands outside or inside a Secure Session.</p>
<ul>
<li>
All APDUs resulting from prepared commands are grouped and sent to the card. </li>
<li>
The <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> object is updated with the result of the executed commands. </li>
<li>
If a secure session is opened, except in the case where reloading or debit SV operations have been prepared, the invocation of this method does not generate communication with the SAM. The data necessary for the calculation of the terminal signature are kept to be sent to the SAM at the time of the invocation of <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a>.<br  />
 The card channel is kept open. </li>
<li>
If no secure session is opened, the card channel is closed depending on whether or not prepareReleaseCardChannel has been called. </li>
<li>
The card session buffer overflows are managed in the same way as in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a219bce34cc30b755709a65934d05ae9f">processOpening()</a>. For example, when the multiple session mode is enabled, the commands are separated in as many sessions as necessary to respect the capacity of the card buffer. </li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_reader_i_o_exception.html">ReaderIOException</a></td><td>If a communication error with the card reader or SAM reader occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_i_o_exception.html">CardIOException</a></td><td>If a communication error with the card occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_sam_i_o_exception.html">SamIOException</a></td><td>If a communication error with the SAM occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_invalid_signature_exception.html">InvalidSignatureException</a></td><td>If a signature associated to a prepared signature verification SAM command is invalid. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_unexpected_command_status_exception.html">UnexpectedCommandStatusException</a></td><td>If a command returns an unexpected status. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_inconsistent_data_exception.html">InconsistentDataException</a></td><td>If inconsistent data have been detected. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_session_buffer_overflow_exception.html">SessionBufferOverflowException</a></td><td>If a secure session is open and multiple session mode is disabled and the session buffer capacity is not sufficient. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_signature_not_verifiable_exception.html">CardSignatureNotVerifiableException</a></td><td>If a secure session is open and multiple session mode is enabled and an intermediate session is correctly closed but the SAM is no longer available to verify the card signature. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_invalid_card_signature_exception.html">InvalidCardSignatureException</a></td><td>If a secure session is open and multiple session mode is enabled and an intermediate session is correctly closed but the card signature is incorrect. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_select_file_exception.html">SelectFileException</a></td><td>If a "Select File" prepared card command indicated that the file was not found. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000011">Deprecated:</a></b></dt><dd>Use <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_common_transaction_manager.html#a905f5a2160cdc54b5d2cebf9a01047da">processCommands()</a> instead. </dd></dl>

</div>
</div>
<a id="a6375c0ed4ce2bdb739e89070582e6d25" name="a6375c0ed4ce2bdb739e89070582e6d25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6375c0ed4ce2bdb739e89070582e6d25">&#9670;&nbsp;</a></span>processChangeKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::processChangeKey </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>keyIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>newKif</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>newKvc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>issuerKif</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>issuerKvc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Replaces one of the current card keys with another key present in the SAM.</p>
<p >This command can be performed only out of a secure session.</p>
<p >The change key process transfers the key from the SAM to the card. The new key is diversified by the SAM from a primary key and encrypted using the indicated issuer key to secure the transfer to the card. All provided KIFs and KVCs must be present in the SAM.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyIndex</td><td>The index of the key to be replaced (1 for the issuer key, 2 for the load key, 3 for the debit key). </td></tr>
    <tr><td class="paramname">newKif</td><td>The KIF of the new key. </td></tr>
    <tr><td class="paramname">newKvc</td><td>The KVC of the new key. </td></tr>
    <tr><td class="paramname">issuerKif</td><td>The KIF of the current card's issuer key. </td></tr>
    <tr><td class="paramname">issuerKvc</td><td>The KVC of the current card's issuer key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If the Change Key command is not available for this card. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If the provided key index is out of range. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>If the command is executed while a secure session is open. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_reader_i_o_exception.html">ReaderIOException</a></td><td>If a communication error with the card reader or SAM reader occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_i_o_exception.html">CardIOException</a></td><td>If a communication error with the card occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_sam_i_o_exception.html">SamIOException</a></td><td>If a communication error with the SAM occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_unexpected_command_status_exception.html">UnexpectedCommandStatusException</a></td><td>If a command returns an unexpected status. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_inconsistent_data_exception.html">InconsistentDataException</a></td><td>If inconsistent data have been detected. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.1.0 </dd></dl>

</div>
</div>
<a id="ad2501b28292232667b71ada5177c2dc3" name="ad2501b28292232667b71ada5177c2dc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2501b28292232667b71ada5177c2dc3">&#9670;&nbsp;</a></span>processChangePin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::processChangePin </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>newPin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Replaces the current PIN with the new value provided.</p>
<p >This command can be performed only out of a secure session. The new PIN code can be transmitted in plain text or encrypted according to the parameter set in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_security_setting.html">CardSecuritySetting</a> (by default the transmission is encrypted).</p>
<p >When the PIN is transmitted plain, this command must be preceded by a successful Verify PIN command (see processVerifyPin(byte[])).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">newPin</td><td>The new PIN code value (4-byte long byte array). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If the PIN feature is not available for this card. </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If the provided argument is out of range. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>If the command is executed while a secure session is open. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_reader_i_o_exception.html">ReaderIOException</a></td><td>If a communication error with the card reader or SAM reader occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_i_o_exception.html">CardIOException</a></td><td>If a communication error with the card occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_sam_i_o_exception.html">SamIOException</a></td><td>If a communication error with the SAM occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_unexpected_command_status_exception.html">UnexpectedCommandStatusException</a></td><td>If a command returns an unexpected status. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_inconsistent_data_exception.html">InconsistentDataException</a></td><td>If inconsistent data have been detected. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="ad40866c6ce1ec0618570dab40dca6886" name="ad40866c6ce1ec0618570dab40dca6886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad40866c6ce1ec0618570dab40dca6886">&#9670;&nbsp;</a></span>processClosing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::processClosing </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Terminates the Secure Session sequence started with <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a219bce34cc30b755709a65934d05ae9f">processOpening()</a>.</p>
<p ><b>Nominal case</b></p>
<p >The previously prepared commands are integrated into the calculation of the session digest by the SAM before execution by the card by anticipating their responses.</p>
<p >Thus, the session closing command containing the terminal signature is integrated into the same APDU group sent to the card via a final card request.</p>
<p >Upon reception of the response from the card, the signature of the card is verified with the SAM.</p>
<p >If the method terminates normally, it means that the secure session closing and all related security checks have been successful; conversely, if one of these operations fails, an exception is raised.</p>
<p ><b>Stored Value</b></p>
<p >If the SV counter was debited or reloaded during the session, an additional verification specific to the SV is performed by the SAM.</p>
<p ><b>Ratification</b></p>
<p >A ratification command is added after the close secure session command when the communication is done in a contactless mode.</p>
<p >The logical channel is closed or left open depending on whether the <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ac2021f9af1caa81ef125d48007e5b0e5">prepareReleaseCardChannel()</a> method has been called before or not.</p>
<p ><b>Card and SAM exchanges in detail</b></p>
<ul>
<li>
All the data exchanged with the card so far, to which are added the last prepared orders and their anticipated answers, are sent to the SAM for the calculation of the session digest. The terminal signature calculation request is also integrated in the same group of SAM Apdu. </li>
<li>
All previously prepared commands are sent to the card along with the session closing command and possibly the ratification command within a single card request. </li>
<li>
The responses received from the card are integrated into CalypsoCard. <br  />
 Note: the reception of the answers of this final card request from the card is tolerant to the non-reception of the answer to the ratification order. </li>
<li>
The data received from the card in response to the logout (card session signature and possibly SV signature) are sent to the SAM for verification. </li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalStateException</td><td>If no session is open. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_reader_i_o_exception.html">ReaderIOException</a></td><td>If a communication error with the card reader or SAM reader occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_i_o_exception.html">CardIOException</a></td><td>If a communication error with the card occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_sam_i_o_exception.html">SamIOException</a></td><td>If a communication error with the SAM occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_invalid_signature_exception.html">InvalidSignatureException</a></td><td>If a signature associated to a prepared signature verification SAM command is invalid. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_unexpected_command_status_exception.html">UnexpectedCommandStatusException</a></td><td>If a command returns an unexpected status. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_inconsistent_data_exception.html">InconsistentDataException</a></td><td>If inconsistent data have been detected. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_session_buffer_overflow_exception.html">SessionBufferOverflowException</a></td><td>If multiple session mode is disabled and the session buffer capacity is not sufficient. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_signature_not_verifiable_exception.html">CardSignatureNotVerifiableException</a></td><td>If session is correctly closed but the SAM is no longer available to verify the card signature. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_invalid_card_signature_exception.html">InvalidCardSignatureException</a></td><td>If session is correctly closed but the card signature is incorrect. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="a219bce34cc30b755709a65934d05ae9f" name="a219bce34cc30b755709a65934d05ae9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a219bce34cc30b755709a65934d05ae9f">&#9670;&nbsp;</a></span>processOpening()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::processOpening </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso.html#a159cc27ed6f503baf59f58b875b7ca71">WriteAccessLevel</a>&#160;</td>
          <td class="paramname"><em>writeAccessLevel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Opens a Calypso Secure Session and then executes all previously prepared commands.</p>
<p >It is the starting point of the sequence:</p>
<ul>
<li>
<div class="fragment"><div class="line"><a class="code hl_function" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a219bce34cc30b755709a65934d05ae9f">processOpening</a>(<a class="code hl_enumeration" href="namespacecalypsonet_1_1terminal_1_1calypso.html#a159cc27ed6f503baf59f58b875b7ca71">WriteAccessLevel</a>) </div>
<div class="ttc" id="aclasscalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager_html_a219bce34cc30b755709a65934d05ae9f"><div class="ttname"><a href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a219bce34cc30b755709a65934d05ae9f">calypsonet::terminal::calypso::transaction::CardTransactionManager::processOpening</a></div><div class="ttdeci">virtual CardTransactionManager &amp; processOpening(const WriteAccessLevel writeAccessLevel)=0</div></div>
<div class="ttc" id="anamespacecalypsonet_1_1terminal_1_1calypso_html_a159cc27ed6f503baf59f58b875b7ca71"><div class="ttname"><a href="namespacecalypsonet_1_1terminal_1_1calypso.html#a159cc27ed6f503baf59f58b875b7ca71">calypsonet::terminal::calypso::WriteAccessLevel</a></div><div class="ttdeci">WriteAccessLevel</div><div class="ttdef"><b>Definition:</b> <a href="_write_access_level_8h_source.html#l00028">WriteAccessLevel.h:28</a></div></div>
</div><!-- fragment --> </li>
<li>
[<a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a2f2b7a1d97efde3898b516dd810e848e">processCardCommands()</a>] </li>
<li>
[...] </li>
<li>
[<a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#a2f2b7a1d97efde3898b516dd810e848e">processCardCommands()</a>] </li>
<li>
<a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a> </li>
</ul>
<p >Each of the steps in this sequence may or may not be preceded by the preparation of one or more commands and ends with an update of the <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> object provided when <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">calypsonet::terminal::calypso::transaction::CardTransactionManager</a> was created.</p>
<p >As a prerequisite for invoking this method, since the Calypso Secure Session involves the use of a SAM, the <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> must have been built in secure mode, i.e. the constructor used must be the one expecting a reference to a valid calypsonet::terminal::calypso::card::CardSecuritySetting object, otherwise a keyple::core::util::cpp::exception::IllegalStateException is raised.</p>
<p >The secure session is opened with the <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso.html#a159cc27ed6f503baf59f58b875b7ca71">calypsonet::terminal::calypso::WriteAccessLevel</a> passed as an argument depending on whether it is a personalization, reload or debit transaction profile.</p>
<p >The possible overflow of the internal session buffer of the card is managed in two ways depending on the setting chosen in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_security_setting.html">calypsonet::terminal::calypso::transaction::CardSecuritySetting</a>.</p>
<ul>
<li>
If the session was opened with the default atomic mode and the previously prepared commands will cause the buffer to be exceeded, then an <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_session_buffer_overflow_exception.html">SessionBufferOverflowException</a> is raised and no transmission to the card is made. <br  />
 </li>
<li>
If the session was opened with the multiple session mode and the buffer is to be exceeded then a split into several secure sessions is performed automatically. However, regardless of the number of intermediate sessions performed, a secure session is opened at the end of the execution of this method. </li>
</ul>
<p >Be aware that in the "MULTIPLE" case we lose the benefit of the atomicity of the secure session.</p>
<p ><b>Card and SAM exchanges in detail</b></p>
<p >When executing this method, communications with the card and the SAM are (in that order) :</p>
<ul>
<li>
Sending the card diversifier (Calypso card serial number) to the SAM and receiving the terminal challenge </li>
<li>
Grouped sending to the card of <ul>
<li>
the open secure session command including the challenge terminal. </li>
<li>
all previously prepared commands </li>
</ul>
</li>
<li>
Receiving grouped responses and updating <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1card_1_1_calypso_card.html">calypsonet::terminal::calypso::card::CalypsoCard</a> with the collected data. </li>
</ul>
<p >For optimization purposes, if the first command prepared is the reading of a single record of a card file then this one is replaced by a setting of the session opening command allowing the retrieval of this data in response to this command.</p>
<p >Please note that the CAAD mechanism may require a file to be read before being modified. For this mechanism to work properly, this reading must not be placed in the first position of the prepared commands in order to be correctly taken into account by the SAM.</p>
<p ><b>Other operations carried out</b></p>
<ul>
<li>
The card KIF, KVC and card challenge received in response to the open secure session command are kept for a later initialization of the session's digest (see <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html#ad40866c6ce1ec0618570dab40dca6886">processClosing()</a>). </li>
<li>
All data received in response to the open secure session command and the responses to the prepared commands are also stored for later calculation of the digest. </li>
<li>
If a list of authorized KVCs has been defined in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_security_setting.html">calypsonet::terminal::calypso::transaction::CardSecuritySetting</a> and the KVC of the card does not belong to this list then an <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_unauthorized_key_exception.html">UnauthorizedKeyException</a> is thrown. </li>
</ul>
<p >All unexpected results (communication errors, data or security errors, etc. are notified to the calling application through dedicated exceptions.</p>
<p ><em>Note: to understand in detail how the secure session works please refer to the card specification documents.</em></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">writeAccessLevel</td><td>An <a class="el" href="namespacecalypsonet_1_1terminal_1_1calypso.html#a159cc27ed6f503baf59f58b875b7ca71">calypsonet::terminal::calypso::WriteAccessLevel</a> enum entry. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IllegalArgumentException</td><td>If the provided argument is null. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>If no <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_security_setting.html">CardSecuritySetting</a> is available. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_reader_i_o_exception.html">ReaderIOException</a></td><td>If a communication error with the card reader or SAM reader occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_i_o_exception.html">CardIOException</a></td><td>If a communication error with the card occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_sam_i_o_exception.html">SamIOException</a></td><td>If a communication error with the SAM occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_invalid_signature_exception.html">InvalidSignatureException</a></td><td>If a signature associated to a prepared signature verification SAM command is invalid. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_unexpected_command_status_exception.html">UnexpectedCommandStatusException</a></td><td>If a command returns an unexpected status. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_inconsistent_data_exception.html">InconsistentDataException</a></td><td>If inconsistent data have been detected. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_unauthorized_key_exception.html">UnauthorizedKeyException</a></td><td>If the card requires an unauthorized session key. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_session_buffer_overflow_exception.html">SessionBufferOverflowException</a></td><td>If multiple session mode is disabled and the session buffer capacity is not sufficient. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_signature_not_verifiable_exception.html">CardSignatureNotVerifiableException</a></td><td>If multiple session mode is enabled and an intermediate session is correctly closed but the SAM is no longer available to verify the card signature. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_invalid_card_signature_exception.html">InvalidCardSignatureException</a></td><td>If multiple session mode is enabled and an intermediate session is correctly closed but the card signature is incorrect. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_select_file_exception.html">SelectFileException</a></td><td>If a "Select File" prepared card command indicated that the file was not found. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<a id="af1698ec8d5bcc6c1c44c72cee5d21165" name="af1698ec8d5bcc6c1c44c72cee5d21165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1698ec8d5bcc6c1c44c72cee5d21165">&#9670;&nbsp;</a></span>processVerifyPin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> &amp; calypsonet::terminal::calypso::transaction::CardTransactionManager::processVerifyPin </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>pin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Performs a PIN verification, in order to authenticate the cardholder and/or unlock access to certain card files.</p>
<p >This command can be performed both in and out of a secure session. The PIN code can be transmitted in plain text or encrypted according to the parameter set in <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_security_setting.html">CardSecuritySetting</a> (by default the transmission is encrypted).</p>
<p >If the execution is done out of session but an encrypted transmission is requested, then <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> must be constructed with <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_security_setting.html">CardSecuritySetting</a></p>
<p >If <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_transaction_manager.html">CardTransactionManager</a> is constructed without <a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_security_setting.html">CardSecuritySetting</a> the transmission in done in plain.</p>
<p >The card channel is closed if prepareReleaseCardChannel is called before this command.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pin</td><td>The PIN code value (4-byte long byte array). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The current instance. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">UnsupportedOperationException</td><td>If the PIN feature is not available for this card </td></tr>
    <tr><td class="paramname">IllegalArgumentException</td><td>If the provided argument is out of range. </td></tr>
    <tr><td class="paramname">IllegalStateException</td><td>If commands have been prepared before invoking this process method. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_reader_i_o_exception.html">ReaderIOException</a></td><td>If a communication error with the card reader or SAM reader occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_card_i_o_exception.html">CardIOException</a></td><td>If a communication error with the card occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_sam_i_o_exception.html">SamIOException</a></td><td>If a communication error with the SAM occurs. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_unexpected_command_status_exception.html">UnexpectedCommandStatusException</a></td><td>If a command returns an unexpected status. </td></tr>
    <tr><td class="paramname"><a class="el" href="classcalypsonet_1_1terminal_1_1calypso_1_1transaction_1_1_inconsistent_data_exception.html">InconsistentDataException</a></td><td>If inconsistent data have been detected. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0 </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/github/workspace/src/main/transaction/<a class="el" href="_card_transaction_manager_8h_source.html">CardTransactionManager.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
